<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SOQCS: live9.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SOQCS
   &#160;<span id="projectnumber">RV 1.5</span>
   </div>
   <div id="projectbrief">Stochastic Optical Quantum Circuit Simulator</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('live9_8cpp-example.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">live9.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p><b>EXAMPLE 9</b>: Dielectric as a balanced beamsplitter with losses<br />
 Calculation of the output probabilities for a small dielectric film acting as a beamsplitter. The resulting values coincide with the ones reported in ref. [1].<br />
 <br />
<b>Description</b>:<br />
 We consider a circuit made of single dielectric thin film as studied in [1]. We reproduce numerically the results presented in Figs 2 and 3 of the same ref. [1] obtained by means of analytical calculations to validate the loss model in SOQCS. Each of the figures correspond to the cases where two photons are injected in the dielectric from the same direction or from opposite ones. Here, both situations are considered as two different input channels therefore we plot the different outcome probabilities as function of the transmission amplitude |t| for each of the two cases | 2, 0 &gt; and | 1, 1 &gt;.<br />
 <br />
 <br />
 [1] Stephen M. Barnett, John Jeffers, Alessandra Gatti, and Rodney Loudon. Quantum optics of lossy beam splitters. Phys. Rev. A, 57:2134–2145, 1998.<br />
 <br />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">const</td><td>int och0 Occupation channel 0 </td></tr>
    <tr><td class="paramname">const</td><td>int och1 Occupation channel 1 </td></tr>
    <tr><td class="paramname">const</td><td>cmplx C Complex constant t=C*r </td></tr>
    <tr><td class="paramname">const</td><td>cmplx maxt Maximum transmission amplitude </td></tr>
    <tr><td class="paramname">const</td><td>int N Maximum number of photons</td></tr>
  </table>
  </dd>
</dl>
<p><br />
 <b> Test 1 </b> Output example t=ir and input |2,0&gt;: </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> och0   =             2;</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> och1   =             0;</div><div class="line"><span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a>  C   =            <a name="a0"></a><a class="code" href="util_8h.html#adb5747b765892dc12ddd17f85caef238">jm</a>;</div><div class="line"><span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a> maxt = 1.0/sqrt(2.0);</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> <a name="a1"></a><a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>      =           100;</div></div><!-- fragment --><p><br />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Test 1   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><div class="image">
<img src="live9_1.png" alt="live9_1.png"/>
</div>
  </td></tr>
</table>
<p><br />
 <b> Test 2 </b> Output example t=r and input |1,1&gt;: </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> och0   =       1;</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> och1   =       1;</div><div class="line"><span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a>  C   =     1.0;</div><div class="line"><span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a> maxt = 1.0/2.0;</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>      =     100;</div></div><!-- fragment --><p><br />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Test 2   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><div class="image">
<img src="live9_2.png" alt="live9_2.png"/>
</div>
  </td></tr>
</table>
<p><br />
 Note that conservation of probability imposes <b>|t &plusmn; r|<sup>2</sup>&lt;=1</b>. It is for that reason that in <b>Test 2</b> we can not have physical values larger than 2|t|<sup>2</sup>=0.5 because |t + r|<sup>2</sup>&gt;1 will break the previous conservation of probability condition.<br />
 <br />
</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="soqcs_8h.html">soqcs.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a name="a2"></a><a class="code" href="live9_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div><div class="line">{</div><div class="line"><span class="comment">//------------------------------------------------------------------------</span></div><div class="line"><span class="comment">//  Configuration constants</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> och0   = 2;                  <span class="comment">// Occupation channel 0</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> och1   = 0;                  <span class="comment">// Occupation channel 1</span></div><div class="line">    <span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a>  C   = <a class="code" href="util_8h.html#adb5747b765892dc12ddd17f85caef238">jm</a>;                 <span class="comment">// Complex constant t=C*r</span></div><div class="line">    <span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a> maxt = 1.0/sqrt(2.0);      <span class="comment">// Maximum transmission amplitude</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>      = 100;                <span class="comment">// Maximum number of photons</span></div><div class="line">    <span class="keyword">const</span> <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a>  dt   = maxt/(<a name="a3"></a><a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a>)(<a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>-1); <span class="comment">// Step increment in transmission amplitude of probability</span></div><div class="line"><span class="comment">//------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;* Test 9b: Dielectric as a balanced beamsplitter with losses&quot;</span> &lt;&lt; endl;</div><div class="line">    cout &lt;&lt; endl;</div><div class="line"></div><div class="line">    <span class="comment">// Create circuit.</span></div><div class="line">    <span class="keyword">auto</span> example = <span class="keyword">new</span> <a name="_a4"></a><a class="code" href="classqocircuit.html">qocircuit</a>(2,1,1,1,0.0,0,0,<span class="keyword">true</span>,<span class="charliteral">&#39;G&#39;</span>);</div><div class="line">    <span class="keyword">auto</span> sim= <span class="keyword">new</span> <a name="_a5"></a><a class="code" href="classsimulator.html">simulator</a>();</div><div class="line"></div><div class="line">    <span class="comment">// Set-up the initial state</span></div><div class="line">    <span class="keyword">auto</span> input= <span class="keyword">new</span> <a name="_a6"></a><a class="code" href="classstate.html">state</a>(example-&gt;num_levels());</div><div class="line">    <a class="code" href="state_8h.html#ac382754610a4d1fd8caf75faa3a356f2">hterm</a> in_term;</div><div class="line">    in_term.resize(1,2);</div><div class="line">    in_term &lt;&lt; och0, och1;</div><div class="line">    input-&gt;<a name="a7"></a><a class="code" href="group___state__operations.html#ga0f32beababbeef350b3140ef0956cdb9">add_term</a>(1.0,in_term,example);</div><div class="line"></div><div class="line">    <span class="comment">// Create output file</span></div><div class="line">    ofstream file;</div><div class="line">    file.open (<span class="stringliteral">&quot;Results.txt&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">// The first two loops are to sweep possible output configurations.</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Calculating output&quot;</span> &lt;&lt; endl;</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l&lt;=och0+och1;l++){    <span class="comment">// ... with l photons</span></div><div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;=l;k++){</div><div class="line">            <a class="code" href="util_8h.html#ab0461c82bfcb8fd38418f4523dc3af6f">cmplx</a> t=0.0;</div><div class="line">            <a class="code" href="state_8h.html#ac382754610a4d1fd8caf75faa3a356f2">hterm</a> out_term;</div><div class="line">            out_term.resize(2,2);</div><div class="line">            out_term &lt;&lt;   0,     1,</div><div class="line">                        l-k,     k;</div><div class="line">            file &lt;&lt; <span class="stringliteral">&quot;Out: &quot;</span> &lt;&lt; l-k &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k &lt;&lt; endl;</div><div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;(<a class="code" href="live4_8cpp.html#ab2b6b0c222cd1ce70d6a831f57241e59">N</a>-1);i++){</div><div class="line">                <span class="comment">// Create circuit</span></div><div class="line">                example-&gt;reset();</div><div class="line">                example-&gt;dielectric(0,1,t,C*t);</div><div class="line">                example-&gt;detector(0);</div><div class="line">                example-&gt;detector(1);</div><div class="line"></div><div class="line">                <span class="comment">// Simulate</span></div><div class="line">                <span class="keyword">auto</span> output=sim-&gt;run(input,example,0);</div><div class="line"></div><div class="line">                <span class="comment">// Compute output and obtain probability</span></div><div class="line">                <span class="keyword">auto</span> outcome=<span class="keyword">new</span> <a name="_a8"></a><a class="code" href="classp__bin.html">p_bin</a>(example-&gt;num_levels());</div><div class="line">                outcome-&gt;<a name="a9"></a><a class="code" href="group___bin__update.html#ga7f540970147b3564a5f4277316fddc3f">add_state</a>(output);</div><div class="line">                <span class="keyword">auto</span> measure=outcome-&gt;calc_measure(example);</div><div class="line">                <span class="keyword">auto</span> prob=measure-&gt;prob(out_term,example);</div><div class="line"></div><div class="line">                <span class="comment">// Print output</span></div><div class="line">                file &lt;&lt; 2*real(conj(t)*t) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; prob &lt;&lt; endl;</div><div class="line"></div><div class="line">                <span class="comment">// Increase step</span></div><div class="line">                t=t+dt;</div><div class="line"></div><div class="line">                <span class="comment">// Free memory</span></div><div class="line">                <span class="keyword">delete</span> output;</div><div class="line">                <span class="keyword">delete</span> outcome;</div><div class="line">                <span class="keyword">delete</span> measure;</div><div class="line">            }</div><div class="line">            file &lt;&lt; endl;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Finished. Output printed in Results.txt&quot;</span> &lt;&lt; endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//*********************************************************************************************************</span></div><div class="line"><span class="comment">// Copyright © 2023 National University of Ireland Maynooth, Maynooth University. All rights reserved.    *</span></div><div class="line"><span class="comment">// The contents of this file are subject to the licence terms detailed in LICENCE.TXT available in the    *</span></div><div class="line"><span class="comment">// root directory of this source tree. Use of the source code in this file is only permitted under the    *</span></div><div class="line"><span class="comment">// terms of the licence in LICENCE.TXT.                                                                   *</span></div><div class="line"><span class="comment">//*********************************************************************************************************</span></div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<html lang="en">
<style type="text/css">
<style>
.footer {
    background:white;   
}
.ft-list {
    text-align:left;
    list-style:none;
    overflow:hidden;/*contain floats*/
    margin:0 auto;
    padding:0;
    height:150px;
    background:white;
    border-top-width: 1px;
    border-top-style: solid;
    border-top-color: darkblue;
}
.ft-list li {
    float:right;
    margin:0 15px 0 0;
    background:white;
}
.ft-list li.last {margin:0;}
</style>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<div class="ft-list"
  <ul>
     <li>
            <p style="color:black"> 
            <b>Maynooth Univeristy</b><br>
            <img src="../assets/Maynooth2.png"/>
            </p>
    </li>
    <li>
            <p style="color:black">
            <b>Copyright:</b><br>
            Copyright Â© 2023 National University of Ireland Maynooth, 
            <br> Maynooth University. All rights reserved.<br>
            The contents and use of this document and the related code <br>
            are subject to the licence terms detailed in <a  href="../assets/LICENCE.TXT"> LICENCE.txt </a> 
            </p>
    </li>
    <li>
            <p style="color:black">
            <br>
            Jiri Vala <br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:jiri.vala@mu.ie">jiri.vala@mu.ie</a>
            </p>
    </li>
    <li class="last">
            <p style="color:black">
            <b>Authorship:</b><br>
            Javier Osca Cotarelo<br>
            <br>
            <b>e-mail:</b><br>
            <a  href="mailto:soqcslib@gmail.com">soqcslib@gmail.com</a>
            </p>
    </li>
  </ul>
</div>
</div>
</html>
